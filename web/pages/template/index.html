<!DOCTYPE html>
<html lang="en">

<head>
    <title>Question</title>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <script src="/assets/js/jquery.min.js"></script>
</head>

<body>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <!------ Include the above in your HEAD tag ---------->
    <nav class="navbar navbar-default">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="collapsed navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-6" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a href="#" class="navbar-brand">Brand</a>
            </div>
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-6">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    <li class="active">
                        <a href="/template">Template</a>
                    </li>
                    <li>
                        <a href="/chat">Chat Bot</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        <form class="form-inline">
            <h4>Add Template</h4>   
            <hr>
            <div class="form-group">
              <label for="template">Template Name:</label>
              <input type="text" name="template" value="" id="tName" placeholder="Name" />
            </div>
            <button type="submit" class="btn btn-default" onclick="addTemplate()">Add</button>
          </form>
        <!-- <div class="row">
            <div class="col-md-12">
                <input type="text" name="template" value="" id="tName" placeholder="Template name" />
                <input type="button" name="name" value="Add template" onclick="addTemplate()" />
            </div>
        </div> -->
    </br>
        <div class="row">
            <div class="col-md-12">
                <div id="allTemplate">

                </div>
            </div>
        </div>

    </div>

    <script>
        var urlBase = "/api/template/";
        $(document).ready(function () {
            getAll();
        });
        function addTemplate() {
            var data = JSON.stringify({ name: $("#tName").val() });
            $.ajax({
                method: "POST",
                url: urlBase + "add-template",
                contentType: "application/json",
                data: data,
                success: (data) => {
                    getAll();
                    alert("Ok");
                },
                error: () => {
                    alert("Error");
                }
            });
        }
        function getAll() {
            $.ajax({
                method: "GET",
                url: urlBase + "all",
                contentType: "application/json",
                success: (data) => {
                    debugger;
                    data = data.data;
                    // var html = "<ul>";
                    // data.forEach((el, ndx, arr) => {
                    //     html += "<li>" + el.name + "<button onclick=deleteT('" + el.id + "')>Delete</button></li>";
                    // });
                    // html += "</ul>";
                    var table = `<table class='table table-hover' ><tr><th>Template Name</th><th>Action</th></tr>`;
                data.forEach(el => {
                table += `<tr><td>${el.name}</td><td><a onClick="deleteT(` + el.id + `)">Delete</a></td></tr>`;
                });
                table += `</table>`;
                $("#allTemplate").empty();
                    $("#allTemplate").html(table);
                    table = "";
                },
                error: () => {
                    alert("Error");
                }
            });
        }
        function deleteT(id) {
            var data = JSON.stringify({ id: id });
            $.ajax({
                method: "POST",
                url: urlBase + "del-template",
                contentType: "application/json",
                data: data,
                success: (data) => {
                    getAll();
                    alert("Ok");
                },
                error: () => {
                    alert("Error");
                }
            });
        }
    </script>
</body>

</html>